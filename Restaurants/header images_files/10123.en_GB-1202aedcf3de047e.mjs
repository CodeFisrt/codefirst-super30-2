(self.modernJsonp=self.modernJsonp||[]).push([["10123"],{177303:function(e,t,n){var i,a;n.r(t),n.d(t,{default:()=>o});let l={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"userDidItData"}],kind:"Fragment",metadata:null,name:"CommentThreadContainerLikeMutation",selections:a=[{alias:null,args:[{fields:[{kind:"Variable",name:"userDidItData",variableName:"userDidItData"}],kind:"ObjectValue",name:"input"}],concreteType:null,kind:"LinkedField",name:"v3LikeUserDidItDataMutation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"CommentThreadContainerLikeMutation",selections:a},params:{id:"0e45555e33d7c8c17de577cb4e5213ff3568b1b3f3e6694041407c0dad67674d",metadata:{},name:"CommentThreadContainerLikeMutation",operationKind:"mutation",text:null}};l.hash="6abad0b1546231dd9301ca5510fb88f5";let o=l},483416:function(e,t,n){var i,a;n.r(t),n.d(t,{default:()=>o});let l={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"userDidItData"}],kind:"Fragment",metadata:null,name:"CommentThreadContainerUnLikeMutation",selections:a=[{alias:null,args:[{fields:[{kind:"Variable",name:"userDidItData",variableName:"userDidItData"}],kind:"ObjectValue",name:"input"}],concreteType:null,kind:"LinkedField",name:"v3UnlikeUserDidItDataMutation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"CommentThreadContainerUnLikeMutation",selections:a},params:{id:"8f06f078d5b50aa7a3b5e86afda41af9f9ff89d14d2620f3f830abe11ce26f6e",metadata:{},name:"CommentThreadContainerUnLikeMutation",operationKind:"mutation",text:null}};l.hash="e8e5a11ac4f4d2e8c4a2ed9c7ee3c073";let o=l},966597:function(e,t,n){var i,a;n.r(t),n.d(t,{default:()=>o});let l=(a=[i={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CommentThreadContainer_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"commentCount",storageKey:null},{alias:null,args:null,concreteType:"AggregatedDidItData",kind:"LinkedField",name:"didItData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imagesCount",storageKey:null}],storageKey:null},i],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commentsDisabled",storageKey:null},i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});l.hash="38e173ab2c3107ebc5b3da9f216fac98";let o=l},488966:function(e,t,n){var i,a,l,o;n.r(t),n.d(t,{default:()=>r});let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DescriptionWithLinksAndMentions_pin",selections:[{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"descriptionLinks",plural:!0,selections:[i={alias:null,args:null,kind:"ScalarField",name:"length",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"objectId",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"offset",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"tagType",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"userMentionTags",plural:!0,selections:[i,a,l,o],storageKey:null},{args:null,kind:"FragmentSpread",name:"useHyperlinkExperiment_pin"}],type:"Pin",abstractKey:null};s.hash="93be5ba2b479913d0e23e4971f11a9cd";let r=s},100554:function(e,t,n){var i,a,l,o,s;n.r(t),n.d(t,{default:()=>d});let r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"VisualContext_pin",selections:[{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"v720P",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"thumbnail",storageKey:null},i={alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"duration",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"captionsUrls",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV4",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"VideoDetail",kind:"LinkedField",name:"vHLSV3MOBILE",plural:!1,selections:o,storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"Embed",kind:"LinkedField",name:"embed",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"type",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"src",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"subtype",storageKey:null}],storageKey:null},{alias:"images_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s=[l,i,a],storageKey:'images(spec:"564x")'},{alias:"images_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"736x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"orig")'},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"474x")'},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"236x")'},{alias:"images_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:s,storageKey:'images(spec:"1200x")'},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isVideo",storageKey:null},{args:null,kind:"FragmentSpread",name:"useGetMainPinImage_pin"}],type:"Pin",abstractKey:null};r.hash="08cd44e128b47bb7c9b6b57bde25cae7";let d=r},562802:function(e,t,n){var i;n.r(t),n.d(t,{default:()=>l});let a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useGetMainPinImage_pin",selections:[{alias:"images_564x",args:[{kind:"Literal",name:"spec",value:"564x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i=[{alias:null,args:null,kind:"ScalarField",name:"height",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"width",storageKey:null}],storageKey:'images(spec:"564x")'},{alias:"images_736x",args:[{kind:"Literal",name:"spec",value:"736x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i,storageKey:'images(spec:"736x")'},{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i,storageKey:'images(spec:"orig")'},{alias:"images_474x",args:[{kind:"Literal",name:"spec",value:"474x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i,storageKey:'images(spec:"474x")'},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i,storageKey:'images(spec:"236x")'},{alias:"images_1200x",args:[{kind:"Literal",name:"spec",value:"1200x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:i,storageKey:'images(spec:"1200x")'}],type:"Pin",abstractKey:null};a.hash="bd2991a5190c2f6977d6f49024eb3318";let l=a},219077:function(e,t,n){n.d(t,{Z:()=>l});var i=n(667294);let a="undefined"!=typeof document?document:{},l=()=>{let e=(0,i.useRef)(void 0),t=a.documentElement,{body:n}=a;return t?[()=>{if(!n||!n.style||e.current)return;let i=window.innerWidth-t.clientWidth,a=parseInt(window.getComputedStyle(n).getPropertyValue("padding-right"),10)||0;t.style.position="relative",t.style.overflow="hidden",n.style.position="relative",n.style.overflow="hidden",n.style.paddingRight=`${a+i}px`,e.current=!0},()=>{n&&n.style&&e.current&&(t.style.position="",t.style.overflow="",n.style.position="",n.style.overflow="",n.style.paddingRight="",e.current=!1)}]:[]}},300704:function(e,t,n){n.d(t,{Z:()=>s});var i=n(667294),a=n(514223),l=n(767415);class o extends i.PureComponent{constructor(...e){var t,n,i;super(...e),t="handleKeyDown",n=e=>{let{onClose:t,goToNext:n,goToPrevious:i}=this.props,o=e.keyCode||e.code;!e.ctrlKey&&!e.metaKey&&(["input","select","button","textarea"].includes(((document.activeElement||{}).tagName||"").toLowerCase())||document.activeElement&&document.activeElement.isContentEditable||(o===a.Z.LEFT?(e.preventDefault(),e.stopPropagation(),i&&i(),(0,l.nP)("web_keydown_left")):o===a.Z.RIGHT?(e.preventDefault(),e.stopPropagation(),n&&n(),(0,l.nP)("web_keydown_right")):o===a.Z.ESCAPE&&(e.preventDefault(),e.stopPropagation(),t())))},(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){return null}}let s=o},77957:function(e,t,n){n.d(t,{A:()=>h,G:()=>m});var i,a=n(667294);n(167912);var l=n(213491),o=n(183e3),s=n(566431),r=n(296339),d=n(785893);let{Provider:c,get:m}=(0,l.Z)("VisualContext"),u=(void 0!==i||(i=n(100554)).hash&&"08cd44e128b47bb7c9b6b57bde25cae7"!==i.hash&&console.error("The definition of 'VisualContext_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),g=({children:e,pinKey:t,overrideValue:n={}})=>{let i=(0,o.Z)(u,t),{videos:l,embed:m,link:g,isVideo:h}=i??{},p=(0,a.useMemo)(()=>l?.videoList?.v720P?.url?{duration:l.videoList.v720P.duration||void 0,height:l.videoList.v720P.height||void 0,thumbnail:l.videoList.v720P.thumbnail||void 0,url:l.videoList.v720P.url||void 0,width:l.videoList.v720P.width||void 0,captions_urls:l.videoList.v720P.captionsUrls||void 0}:void 0,[l?.videoList?.v720P?.duration,l?.videoList?.v720P?.height,l?.videoList?.v720P?.thumbnail,l?.videoList?.v720P?.url,l?.videoList?.v720P?.width,l?.videoList?.v720P?.captionsUrls]),_=(0,a.useMemo)(()=>l?.videoList?.vHLSV4?.url?{duration:l.videoList.vHLSV4.duration||void 0,height:l.videoList.vHLSV4.height||void 0,thumbnail:l.videoList.vHLSV4.thumbnail||void 0,url:l.videoList.vHLSV4.url||void 0,width:l.videoList.vHLSV4.width||void 0}:void 0,[l?.videoList?.vHLSV4?.duration,l?.videoList?.vHLSV4?.height,l?.videoList?.vHLSV4?.thumbnail,l?.videoList?.vHLSV4?.url,l?.videoList?.vHLSV4?.width]),y=(0,a.useMemo)(()=>l?.videoList?.vHLSV3MOBILE?.url?{duration:l.videoList.vHLSV3MOBILE.duration||void 0,height:l.videoList.vHLSV3MOBILE.height||void 0,thumbnail:l.videoList.vHLSV3MOBILE.thumbnail||void 0,url:l.videoList.vHLSV3MOBILE.url||void 0,width:l.videoList.vHLSV3MOBILE.width||void 0}:void 0,[l?.videoList?.vHLSV3MOBILE?.duration,l?.videoList?.vHLSV3MOBILE?.height,l?.videoList?.vHLSV3MOBILE?.thumbnail,l?.videoList?.vHLSV3MOBILE?.url,l?.videoList?.vHLSV3MOBILE?.width]),x=(0,a.useMemo)(()=>{let e=p||_||y;return l?.entityId&&e?{id:l.entityId,hasVideo:e,mp4:p||void 0,hls:_||void 0,hlsv3:y||void 0}:null},[_,y,p,l?.entityId]),f=(0,s.sY)(m?.type),v=(0,s.oU)({isVideo:h,link:g}),{mainPinImage:b,srcSet:k,srcSizes:L}=(0,r.Z)({pinKey:i}),C=i?.images_1200x||i?.images_orig||i?.images_736x||i?.images_564x||i?.images_474x||i?.images_236x,I=(0,a.useMemo)(()=>({height:C?.height??1,url:C?.url??"",width:C?.width??1}),[C]),w=i?.images_236x,T=(0,a.useMemo)(()=>w?.url?{height:w.height??1,url:w.url,width:w.width??1}:null,[w]),j=(0,a.useMemo)(()=>{let e=m?.subtype==="pinstory",t=n.mainImage||b,i=n?.carouselInfo?.carouselData?.index??0,a=n?.carouselInfo?.carouselData?.carousel_slots,l=(null!=i&&a&&a[i]?.link||null)??g??"";return{...n,mainImage:t,previewImage:void 0===n.previewImage?T:n.previewImage,mediaViewerImage:I,video:x,embed:m,isYoutubePin:v,isEmbeddedVideo:!!m?.src&&!f&&!e,isGif:f,imgSrc:f&&m?.src?m.src:t.url,...f?{}:{srcSet:k},srcSizes:L,finalLink:l}},[b,T,I,x,m,v,f,k,L,n,g]);return(0,d.jsx)(c,{value:j,children:e})},h=({children:e,pinKey:t,overrideValue:n={}})=>(0,d.jsx)(g,{overrideValue:n,pinKey:t,children:e})},677650:function(e,t,n){n.d(t,{Z:()=>o});var i=n(399353),a=n(785893);let l=/^(?!.*#.*#)#[\p{L}\p{N}_]\S*$/gu;function o({closeupWithinMasonryEnabled:e=!1,peekCloseupEnabled:t=!1,mWebCloseupRedesignEnabled:n=!1,text:o}){let s=t||n?"200":"300";return o.split(new RegExp(/(#\S*)/)).map((t,n)=>{let o=`${n}-${t}`;return t.match(l)?(0,a.jsx)(i.xe,{color:"link",inline:!0,size:s,children:(0,a.jsx)(i.rU,{display:"inline",href:`/search/pins/?q=${encodeURIComponent(t.replace("#",""))}`,underline:"none",children:t})},o):(0,a.jsx)(i.xe,{color:e?"subtle":void 0,inline:!0,size:s,children:t},o)})}},282636:function(e,t,n){n.d(t,{Z:()=>x});var i,a=n(686659),l=n(667294);n(244311);var o=n(399353),s=n(41045),r=n(677650),d=n(230201),c=n(183e3),m=n(721703),u=n(113759),g=n(785893);let h=(void 0!==i||(i=n(488966)).hash&&"93be5ba2b479913d0e23e4971f11a9cd"!==i.hash&&console.error("The definition of 'DescriptionWithLinksAndMentions_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),p=e=>null!=e&&e>-1,_=({color:e,mention:t,tagObjectId:n,tagType:i,textSize:a})=>{let{logContextEvent:l}=(0,d.u)();return(0,g.jsx)(o.rU,{display:"inlineBlock",href:`/${t.substr(1)}`,onClick:({event:e})=>{e.stopPropagation(),l({event_type:101,element:11915,aux_data:{tag_id:n,tag_type:i}})},underline:"none",children:(0,g.jsx)(o.xe,{color:e,inline:!0,overflow:"normal",size:a,weight:"bold",children:t},t)},n)},y=({color:e,link:t,tagObjectId:n,tagType:i,text:a,textSize:l})=>{let{logContextEvent:s}=(0,d.u)(),r=(0,m.Z)({site:"www"}),c=t.startsWith("pinterest://")?t.replace("pinterest://",`${r}/`):t;return(0,g.jsx)(o.xe,{color:e,inline:!0,overflow:"normal",size:l,children:(0,g.jsx)(o.rU,{display:"inlineBlock",href:c,onClick:({event:e})=>{e.stopPropagation(),s({event_type:101,element:18123,aux_data:{tag_id:n,tag_type:i,url:t}})},underline:"hover",children:a},n)},a)},x=({description:e,mentionLinkColor:t,pinKey:n,shouldAdjustOffset:i,shouldMakeHashtagLinksFromText:o,textSize:d,descriptionLinks:m,userMentionTags:x})=>{(0,l.useEffect)(()=>{(0,a.Z)("DescriptionWithLinksAndMentions","/app/common/react/components/do/rich-pins/DescriptionWithLinksAndMentions/DescriptionWithLinksAndMentions.tsx")},[]);let{closeupWithinMasonryEnabled:f,peekCloseupEnabled:v}=(0,u.x4)(),b=(0,c.Z)(h,n),{hyperlinkKeywordsEnabled:k}=(0,s.Z)(b),L=x?.length?x.map(e=>({...b?.userMentionTags?.find(t=>t.offset===e.originalOffset),...e})):b?.userMentionTags??[],C=m?.length?m.map(e=>({...b?.descriptionLinks?.find(t=>t.offset===e.originalOffset),...e})):b?.descriptionLinks??[],I=L.length>0,w=k&&C.length>0;if(!I&&!w)return(0,g.jsx)(l.Fragment,{children:e});let T=0,j=[];return[...L.map(t=>({...t,type:"mention",offset:i?((e,t)=>{let n=t.substr(0,e);return(e??0)-(n.length-n.replace(/\s+/g," ").length)})(t.offset??0,e):t.offset??0})),...k?C.map(e=>({...e,type:"link",offset:e.offset??0})):[]].filter(e=>p(e.offset)&&p(e.length)).sort((e,t)=>(e.offset??0)-(t.offset??0)).forEach(n=>{let i=n?.offset??0,a=n?.length??0,l=e.substr(T,i-T),o=e.substr(i,a);j.push(l),n?.type==="mention"?j.push((0,g.jsx)(_,{color:t,mention:o,tagObjectId:n.objectId,tagType:n.tagType,textSize:d})):n?.type==="link"&&n?.link&&j.push((0,g.jsx)(y,{color:t,link:n.link,tagObjectId:n.objectId,tagType:n.tagType,text:o,textSize:d})),T=i+a}),j.push(e.substr(T)),(o?j.flatMap(e=>"string"!=typeof e?e:(0,r.Z)({closeupWithinMasonryEnabled:f,peekCloseupEnabled:v,text:e})):j).reduce((e,t)=>(0,g.jsxs)(l.Fragment,{children:[e,t]}),null)}},21558:function(e,t,n){n.d(t,{E:()=>r,N:()=>d});var i=n(667294),a=n(786482),l=n(213491),o=n(785893);let{Provider:s,get:r}=(0,l.Z)("Flag"),d=({children:e})=>{let[t,n]=(0,i.useState)(),[l,r]=(0,i.useState)(a.Zw.REPORT),[d,c]=(0,i.useState)(a.qb.STARTED),[m,u]=(0,i.useState)(),[g,h]=(0,i.useState)(),p=(0,i.useMemo)(()=>({flagReason:g,flow:l,status:d,selectedReason:m,modalTitle:t,setFlagReason:h,setFlow:r,setModalTitle:n,setStatus:c,setSelectedReason:u}),[t,l,d,m,g]);return(0,o.jsx)(s,{value:p,children:e})}},786482:function(e,t,n){n.d(t,{Vm:()=>l,Zw:()=>i,qb:()=>a});let i={REPORT:"REPORT",BLOCK:"BLOCK",END:"END"},a={STARTED:"STARTED",SELECTED:"SELECTED",SUBMITTED:"SUBMITTED",PROCESSING:"PROCESSING",COMPLETED:"COMPLETED"},l={CONVERSATION:"CONVERSATION",DID_IT:"DID_IT"}},992998:function(e,t,n){n.d(t,{Z:()=>d});var i=n(686659),a=n(667294),l=n(399353),o=n(319226),s=n(24246),r=n(785893);let d=({isQuestion:e,name:t,size:n,src:d})=>{(0,a.useEffect)(()=>{(0,i.Z)("CommentAvatar","/app/packages/comment/CommentAvatar.tsx")},[]);let c=(0,s.Z)();return(0,r.jsxs)(l.xu,{"data-test-id":"comment-avatar-container",position:"relative",children:[(0,r.jsx)(o.qE,{name:t,size:n,src:d}),e&&(0,r.jsxs)(l.xu,{alignItems:"center",bottom:!0,display:"flex",height:16,justifyContent:"center",marginBottom:-1,marginEnd:-1,position:"absolute",right:!0,width:16,children:[(0,r.jsx)(l.xu,{position:"absolute",children:(0,r.jsx)(l.JO,{accessibilityLabel:c.bt("Q&A comment", "Q and A comment", "comment.userAvatar.creator.q&aIndicator", undefined, true),color:"dark",icon:"speech-fill"})}),(0,r.jsx)(l.xu,{position:"absolute",children:(0,r.jsx)(l.JO,{accessibilityLabel:c.bt("Q&A comment", "Q and A comment", "comment.userAvatar.creator.q&aIndicator", undefined, true),color:"light",icon:"circle-question-mark",size:8})})]})]})}},671862:function(e,t,n){n.d(t,{Z:()=>er});var i=n(686659),a=n(667294),l=n(399353),o=n(581722),s=n(209377),r=n(219077),d=n(331128),c=n(21558),m=n(992998),u=n(458465),g=n(333651),h=n(773655),p=n(319226),_=n(785893);let y={helpfulStyle:{backgroundImage:`url(${g})`},lovedStyle:{backgroundImage:`url(${h})`}},x=({response:e,handleReactionListHover:t,maybeDismissReactionListWithDelay:n})=>{(0,a.useEffect)(()=>{(0,i.Z)("ReactionUser","/app/packages/comment/ReactionUser.tsx")},[]);let o=14===e.reaction_type,s=1===e.reaction_type,r=e.user.is_private_profile?e.user.first_name:e.user.full_name;return(0,_.jsxs)(l.kC,{alignItems:"center",children:[(0,_.jsx)(l.Tg,{href:`/${e.user.username}/`,onBlur:n,onFocus:t,children:(0,_.jsxs)(l.kC,{alignItems:"center",children:[(0,_.jsx)(l.xu,{maxWidth:40,children:(0,_.jsx)(p.qE,{accessibilityLabel:"",name:r,outline:!0,size:"sm",src:e.user.image_medium_url})}),(0,_.jsx)(l.xu,{marginStart:2,maxWidth:80,children:(0,_.jsx)(l.xe,{size:"100",weight:"bold",children:r})})]})}),(0,_.jsxs)(l.xu,{alignContent:"end",display:"flex",padding:2,children:[s&&(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:y.lovedStyle},"data-test-id":"comment-reaction-tray-loved-emoji",height:16,width:16}),o&&(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:y.helpfulStyle},"data-test-id":"comment-reaction-tray-helpful-emoji",height:16,width:16})]})]})};var f=n(935059),v=n(661376),b=n(200619),k=n(601871);let L=["userreaction.id","userreaction.reaction_type","userreaction.user()","user.first_name","user.full_name","user.id","user.image_medium_url","user.is_private_profile","user.username"],C=({commentId:e,handleReactionListHover:t,isMarkedHelpfulByMe:n,isLovedByMe:o,isTry:s,maybeDismissReactionListWithDelay:r})=>{(0,a.useEffect)(()=>{(0,i.Z)("ReactionList","/app/packages/comment/ReactionList.tsx")},[]);let d=(0,f.Z)(),c=(0,b.Z)(),m=(0,v.Z)({name:"ApiResource",options:{url:s?`/v3/did_it/${e}/reacted_by/`:`/v3/aggregated_comments/${e}/reacted_by/`,field_sets:L}}),u=(0,k.lJ)(d,c)||("id"in d&&d.id?d.id:""),g=m.data;(o||n)&&g&&(g=g.filter(e=>e.user.id!==u),g=[{id:e,reaction_type:o?1:14,user:{first_name:(0,k.Fk)(d,c),full_name:(0,k.Fk)(d,c),id:u,image_medium_url:(0,k.gJ)(d,c),is_private_profile:!!d.isAuth&&!!d.isPrivateProfile,username:(0,k.Ms)(d,c)}},...g]);let h=(0,a.useRef)(null);return(0,a.useEffect)(()=>{let{current:e}=h,t=()=>{m.isFetching||(m.isAtEnd?e?.removeEventListener("scroll",t):m.fetchMore())};return e?.addEventListener("scroll",t),()=>{e?.removeEventListener("scroll",t)}},[m]),(0,_.jsx)(l.xu,{ref:h,maxHeight:140,overflow:"auto",rounding:200,width:200,children:g?.map(e=>(0,_.jsx)(l.xu,{"data-test-id":"reaction-list-single-user",margin:3,children:(0,_.jsx)(x,{handleReactionListHover:t,maybeDismissReactionListWithDelay:r,response:e})},e.id))})};var I=n(24246),w=n(216975),T=n(825605),j=n(113759);let P=(0,a.lazy)(()=>n.e("22979").then(n.bind(n,674565))),S="comment-reaction-container-entry-point",A=({commentId:e,dismissReactionList:t,helpfulCount:n,isDesktop:o,isMarkedHelpfulByMe:s,isLovedByMe:r,isReactionListOpen:d,isTry:c,lovedCount:m,onReactionCountHover:p,onToggleHelpful:y,onToggleLove:x})=>{(0,a.useEffect)(()=>{(0,i.Z)("CommentReactionContainer","/app/packages/comment/CommentReactionContainer.tsx")},[]);let f=(0,I.Z)(),{isCommentComposerFocused:v}=(0,j.x4)(),b=(0,a.useRef)(null),k=o?16:12,[L,A]=(0,a.useState)(!1),E=!1,D=(m||0)+(n||0);s&&r&&(D-=1);let z=e=>()=>{A(e)},M=()=>{E=!0,p()},R=()=>{E=!1,setTimeout(()=>{E||t()},1e3)},Z=o?(0,_.jsx)(l.xu,{"data-test-id":S,children:L?(0,_.jsx)(l.iP,{onMouseLeave:z(!1),onTap:z(!1),children:(0,_.jsx)(T.Z,{children:(0,_.jsx)(P,{onTooltipHover:z(!1),setHelpful:y(!0),setLoved:x(!0)})})}):(0,_.jsx)(l.iP,{onMouseEnter:z(!0),onTap:z(!0),children:(0,_.jsx)(l.JO,{accessibilityLabel:f.bt("React", "React", "comment.actionbar.react", undefined, true),color:"subtle",icon:"heart",size:k})})}):(0,_.jsx)(l.xu,{"data-test-id":S,margin:-1.5,children:(0,_.jsx)(l.hU,{accessibilityLabel:f.bt("React", "React", "comment.actionbar.react", undefined, true),icon:"heart",onClick:x(!0),size:"xs"})});return(0,_.jsxs)(l.kC,{alignItems:"center",gap:{row:o?1:1.5,column:0},children:[s||r?(0,_.jsx)(l.iP,{onTap:()=>{y(!1)(),x(!1)()},children:(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${r?h:g})`,backgroundSize:"contain"}},"data-test-id":r?"comment-reaction-container-loved-emoji":"comment-reaction-container-helpful-emoji",height:k,width:k})}):Z,D>0&&(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(l.iP,{accessibilityLabel:(0,w.Wc)(f.nbt(["{{reactionCount}} reaction", "{{reactionCount}} reactions"], D, "Comment.CommentReactionContainer.ariaLabel", true),{reactionCount:D.toString()}),onMouseEnter:M,onMouseLeave:R,onTap:M,children:(0,_.jsx)(l.xu,{ref:b,"data-test-id":"comment-reaction-container-reaction-count",display:o?void 0:"flex",children:(0,_.jsx)(l.xe,{color:o?"subtle":"default",inline:!0,size:o?"200":"100",weight:"bold",children:D})})}),d&&(0,_.jsx)(l.mh,{zIndex:u.Ty,children:(0,_.jsx)(l.J2,{anchor:b.current,idealDirection:"down",onDismiss:t,positionRelativeToAnchor:!1,shouldFocus:!v,children:(0,_.jsx)(l.iP,{onMouseEnter:M,onMouseLeave:R,children:(0,_.jsx)(C,{commentId:e,handleReactionListHover:M,isLovedByMe:r,isMarkedHelpfulByMe:s,isTry:c,maybeDismissReactionListWithDelay:R})})})})]})]})};var E=n(812928),D=n(634395),z=n(351979),M=n(299136);function R(e){(0,a.useEffect)(()=>{(0,i.Z)("PhotoCommentContent","/app/packages/comment/PhotoCommentContent.tsx")},[]);let{comment:t,commentTags:n,handlePhotoTap:o,isDesktop:s,previewPhoto:r,taggedUsers:d}=e,[c,m]=(0,a.useState)(!1),{user:{username:u}}=t,g="text"in t?t.text:t.details,h=s?`${u} ${g}`:g,{height:p,url:y,width:x}=r||{},f=p??z.Vb,v=x??z.mu;return(0,_.jsxs)(l.xu,{children:[(0,_.jsx)(M.Z,{isFirstTaggedUserAuthor:!0,shouldShowFirstNameOnly:!0,taggedUsers:d,tags:n,text:h}),s||!s?(0,_.jsx)(l.xu,{marginBottom:s?void 0:1.5,marginTop:s?1:.5,children:(0,_.jsx)(z.ZP,{canEnlargePhoto:s,isSelectedPhoto:!1,previewPhoto:r})}):(0,_.jsx)(l.xu,{height:150,marginBottom:s?4:2,marginTop:1,width:150,children:(0,_.jsx)(l.iP,{disabled:!s,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),onTap:o,children:(0,_.jsx)(l.zd,{rounding:2,wash:!0,children:y&&(0,_.jsx)(l.Ee,{alt:y,color:"#efefef",naturalHeight:f,naturalWidth:v,src:y,children:(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{cursor:s?"zoom-in":void 0,backgroundColor:`rgba(17, 17, 17, ${.4*!!c})`}},height:"100%",width:"100%"})},y)})})})]})}var Z=n(351736),F=n(264267),O=n(438274);function K(e){(0,a.useEffect)(()=>{(0,i.Z)("ReplyThread","/app/packages/comment/ReplyThread.tsx")},[]);let{featuredCommentId:t,parentId:n,parentType:s,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:m,isReadOnly:u,openOverflowMenu:g,replyingToCommentId:h,toggleEditComposer:p,toggleHelpful:y,toggleLike:x,toggleReplyComposer:f,isORBACProfileManager:v,isVideo:b,storyPinDataId:k,pinId:L,closeupAttributionId:C,aggregatedPinDataId:T,closeupAttributionUsername:j,pinnerId:P,reactionListCommentId:S,showReactionListForComment:A,viewParameter:E}=e,D=(0,I.Z)(),z=(0,Z.vs)(),M=(0,F.lV)(),R=(0,o.v9)(({feeds:e})=>{let t=e[`${O.Z.AGGREGATED_COMMENT_REPLIES}:${n}`]||[],i=e[`${O.Z.AGGREGATED_COMMENTS}:${n}`]||[];return t.concat(i).reduceRight((e,{id:t})=>{let n=M[t];return n?[...e,n]:e},[])}),K=(0,a.useRef)(!0),H=(0,a.useRef)(R.length),[N,V]=(0,a.useState)(1),[U,B]=(0,a.useState)(!1),W=N===R.length;return(0,a.useEffect)(()=>{let e=H.current,t=R.length;K.current?t>0&&(K.current=!1):t>e&&B(!0),t!==e&&V(e=>e>1?t:+(t>0)),H.current=t},[R.length]),(0,_.jsxs)(a.Fragment,{children:[R.length>1&&(0,_.jsx)(l.iP,{onTap:()=>{V(W?0:R.length)},children:(0,_.jsxs)(l.xu,{alignItems:c?void 0:"center",display:c?void 0:"flex",marginBottom:c?4:6,children:[c?(0,_.jsx)(l.xu,{display:"inlineBlock",marginEnd:2,children:(0,_.jsx)(l.xe,{color:"subtle",size:"200",weight:"bold",children:"âŽ¯âŽ¯"})}):(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{background:z?"white":"black"}},height:1,marginEnd:2,width:32}),(0,_.jsx)(l.xe,{color:c?"subtle":"default",inline:!0,size:"100",weight:"bold",children:W?D.bt("Hide replies", "Hide replies", "comment.button.hideReplies", undefined, true):(0,w.nk)(D.nbt(["View {{ commentCount }} reply", "View {{ commentCount }} replies"], R.length, "comment.button.showReplies", true),{commentCount:R.length})})]})}),(0,_.jsx)(er,{aggregatedPinDataId:T,closeupAttributionId:C,closeupAttributionUsername:j,comments:(()=>{if(0===N||0===R.length)return[];if(1===N)if(U)return R.slice(-1);else return R.slice(0,1);return R.slice(0,N)})(),commentsDisabled:!1,featuredCommentId:t,gapSize:c?2:6,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:m,isORBACProfileManager:v,isReadOnly:u,isVideo:b,openOverflowMenu:g,parentId:n,parentType:s,pinId:L,pinnerId:P,reactionListCommentId:S,replyingToCommentId:h,showReactionListForComment:A,storyPinDataId:k,toggleEditComposer:p,toggleHelpful:y,toggleLike:x,toggleReplyComposer:f,userAvatarSize:"sm",viewParameter:E})]})}var H=n(230201),N=n(236269),V=n(924591),U=n(995514),B=n(424868),W=n(774838),G=n(233597),$=n(577356),q=n(107889),J=n(118376),Q=n(872003),Y=n(409997),X=n(426130),ee=n(826681),et=n(9065);let en=(0,a.lazy)(()=>n.e("8184").then(n.bind(n,265994))),ei=(0,et.Z)(()=>n.e("73842").then(n.bind(n,715490)),void 0,e=>715490,"app-packages-comment-CommentOverflowPopover",e=>["73842"]),ea=(0,a.lazy)(()=>n.e("90658").then(n.bind(n,167446)));function el(e){let t,n;(0,a.useEffect)(()=>{(0,i.Z)("Comment","/app/packages/comment/Comment.tsx")},[]);let{aggregatedPinDataId:g,closeupAttributionId:h,closeupAttributionUsername:p,comment:y,featuredCommentId:x,inCommentsImprovedDropdownExp:v,inCommentsPopover:L,isDesktop:C,isReadOnly:P,isVideo:S,openOverflowMenu:z,toggleReplyComposer:O,parentId:et,parentType:el=q.o.pin,pinId:eo,storyPinDataId:es,replyingToCommentId:er,showReactionListForComment:ed,showTopCommentHeading:ec,toggleEditComposer:em,toggleHelpful:eu,toggleLike:eg,userAvatarSize:eh,isORBACProfileManager:ep,pinnerId:e_,reactionListCommentId:ey,viewParameter:ex}=e,{user:{id:ef,first_name:ev,id:eb,image_medium_url:ek,username:eL},id:eC,is_translatable:eI,comment_count:ew,helpful_count:eT,tags:ej=[]}=y,[eP,eS]=(0,a.useState)(!1),eA=eP&&y.translatedText||y.text,eE=!eI||""===y.translatedText,eD=(0,J.Z)(),ez=!1,eM=0,eR=!1,eZ=!!y.marked_helpful_by_me,eF=C?[y.user]:[],eO="",eK=new Date;"aggregatedcomment"===y.type?(ez=y.highlighted_by_pin_owner,eM=y.reaction_counts[1],eR=y.reaction_by_me>0,n=y?.media?.sticker,eF.push(...y.tagged_users),eO=C?`${eL} ${eA??""}`:eA??"",eK=new Date(y.created_at)):(eM=y.like_count,eR=y.liked_by_me,t=y.images[0]||{},eO=C?`${eL} ${y.details}`:y.details,eK=new Date(y.done_at));let eH=t?.originals,eN=n||eH,eV=(0,I.Z)(),eU=(0,f.Z)(),{setIsMediaViewerOpen:eB,clientTrackingParams:eW,setIsCommentPopoverInteractionActive:eG}=(0,j.x4)(),{logContextEvent:e$}=(0,H.u)(),{isBot:eq}=(0,W.B)(),{showToast:eJ}=(0,$.dI)(),eQ=(0,o.I0)(),eY=(0,Z.vs)(),eX=(0,a.useRef)(null),{hasApplicableLawForCountry:e0}=(0,Y.ZP)(),e1=!P||e0,e3="aggregatedcomment"===y.type&&1===y.comment_tag,e6=e3&&C,e2=(0,b.Z)(),e9=(0,k.lJ)(eU,e2),{nativeEngagementsHiddenForUser:e7}=(0,Q.G)(),{aggregatedCommentsHiddenForUser:e4,translateAggregatedComment:e5,updateAggregatedComment:e8}=(0,F.nf)(),te=(0,d.Z)(),tt="userdiditdata"===y.type,tn=(0,U.Z)(),ti=eI&&!1,ta=`comment-overflow-popover-${eC}`,tl=(0,u.zs)(eL,ej,eY,!C),to={SHOW_TRANSLATION:eV.bt("Show translation", "Show translation", "comment.translateButton.showTranslation", undefined, true),TRANSLATING:eV.bt("Translating...", "Translating...", "comment.translateButton.translating", undefined, true),SHOW_ORIGINAL:eV.bt("Show original", "Show original", "comment.translateButton.showOriginal", undefined, true)},ts=(0,a.useRef)(to.SHOW_TRANSLATION),[tr,td]=(0,r.Z)(),[tc,tm]=(0,a.useState)(!1),[tu,tg]=(0,a.useState)(!1),[th,tp]=(0,a.useState)(!1),[t_,ty]=(0,a.useState)(!1),[tx,tf]=(0,a.useState)(!1),[tv,tb]=(0,a.useState)(!1),[tk,tL]=(0,a.useState)(!1),[tC,tI]=(0,a.useState)(u.A9.NONE),tw=e=>()=>{em?em(y):tg(e)};(0,a.useEffect)(()=>{ti&&e$({event_type:10416,view_type:3,view_parameter:ex,component:"pin"===el?13696:13697})},[e$,el,ti,ex]),(0,a.useEffect)(()=>{ew>0&&!eq&&eQ((0,G.U)("aggregatedcomment"===y.type?"AggregatedCommentReplyFeedResource":"DidItCommentsResource",{options:{isUnifiedComment:!0,objectId:eC,redux_normalize_feed:!0}}))},[y.type,eC]);let tT=el.toLowerCase()===q.o.aggregatedComment.toLowerCase()||el.toLowerCase()===q.n.didIt.toLowerCase(),tj=y.user.first_name||"",tP=async({contentMarkdown:e,force:t,tags:n})=>{let i,a;ty(!0);let l=y.id;if(tT&&(i=el.toLowerCase()===q.n.didIt,l=et,a=y.id),l)try{await te({force:t,fromUnifiedComment:!0,objectType:tt||i?q.o.didIt:q.o.aggregatedComment,objectId:l,orbacSubjectId:e9,tags:n,text:e,replyToCommentId:a})}catch(t){let e=(0,N.Z)(t,"code");if([B.ky,B.LJ].includes(e??0)&&C)return tI(e===B.ky?u.A9.WARNING:u.A9.BLOCK),ty(!1),!1}return O&&O(void 0),ty(!1),!0},tS=async({contentMarkdown:e,force:t,tags:n})=>{tp(!0);try{tt?await eQ((0,X.IU)({id:y.id,details:e,pinId:eo??"",image_signatures:"image_signatures"in y&&y.image_signatures?y.image_signatures:[]})):await e8({commentId:y.id,force:t,orbacSubjectId:e9,tags:n,text:e})}catch(e){if([B.ky,B.LJ].includes((0,N.Z)(e,"code")??0)&&C)return tI(e.code===B.ky?u.A9.WARNING:u.A9.BLOCK),tp(!1),!1}return tg(!1),tp(!1),!0},tA=()=>{C?(eG(!tc),tm(!tc)):z&&z(y)},tE=e=>()=>{eG(e),tm(e),tL(e),e||e$({component:14349,event_type:9408})},tD=()=>{tI(u.A9.NONE)},tz=e=>{e?td():tr(),eB(!e),tf(!e)};(0,a.useEffect)(()=>{eP&&eE&&(eS(!eP),eJ(({hideToast:e})=>(0,_.jsx)(V.Z,{onHide:e,text:eV.bt("Error â€“ couldn't translate", "Error - couldn't translate", "comment.couldNotTranslate.toast", undefined, true),type:"error"})))},[eP,eE]),eP?ts.current=y.translatedText?to.SHOW_ORIGINAL:to.TRANSLATING:ts.current=to.SHOW_TRANSLATION;let tM=C?128:110,tR="aggregatedcomment"===y.type&&y.media?.sticker?.image_url&&(0,_.jsx)(l.xu,{height:tM,marginBottom:+!!C,marginTop:1,width:tM,children:y.media?.sticker?.image_url&&(0,_.jsx)(l.Ee,{alt:y.media?.sticker?.display_name??"",fit:"contain",naturalHeight:0,naturalWidth:0,src:y.media.sticker.image_url})});return(0,_.jsxs)(a.Fragment,{children:[(0,_.jsx)(l.xH,{accessibilityLabel:"Loading comment",show:th}),!tu&&!th&&(0,_.jsxs)(l.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,_.jsx)(l.xu,{marginEnd:2,children:(0,_.jsx)(s.rU,{to:`/${eL}/`,children:(0,_.jsx)(m.Z,{isQuestion:e6,name:ev||eL||"",size:eh,src:ek??""})})}),(0,_.jsxs)(l.kC,{direction:"column",flex:"grow",justifyContent:"start",children:[(0,_.jsxs)(l.kC,{justifyContent:"between",children:[(0,_.jsx)(l.kC.Item,{minWidth:0,children:(0,_.jsxs)(l.kC,{dataTestId:"author-and-comment-container",direction:"column",children:[!C&&(0,_.jsxs)(l.kC,{alignItems:"center",gap:{row:1,column:0},children:[(0,_.jsx)(M.Z,{isFirstTaggedUserAuthor:!0,lineHeight:"14px",marginEnd:0,shouldShowFirstNameOnly:!0,size:"100",taggedUsers:[y.user],tags:(0,u.zs)(eL,[],eY),text:eL}),e3&&!ec&&(0,_.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:"14px"}},children:(0,_.jsx)(l.xe,{color:"subtle",size:"100",children:eV.bt("asked a question ðŸ‘€", "asked a question ðŸ‘€", "comment.question.label", undefined, true)})}),ec&&(0,_.jsxs)(l.kC,{children:[(0,_.jsx)(l.xu,{alignItems:"center",display:"flex",marginEnd:1,children:(0,_.jsx)(l.JO,{accessibilityLabel:(0,u.yW)(eV),color:"recommendation",icon:"star-fill",size:12})}),(0,_.jsx)(l.xe,{color:"recommendation",size:"100",weight:"bold",children:(0,u._q)(eV)})]}),(e3||ec)&&eK&&(0,_.jsx)(l.xe,{color:"subtle",size:"100",children:"Â·"}),eK&&(0,_.jsx)(l.xu,{"data-test-id":"comments-time-passed",children:(0,_.jsx)(l.xe,{color:"subtle",size:"100",children:tn(eK,!0)})})]}),tt?(0,_.jsx)(R,{comment:y,commentTags:tl,handlePhotoTap:()=>tz(tx),isDesktop:C,previewPhoto:eH,taggedUsers:eF}):(0,_.jsx)(M.Z,{isFirstTaggedUserAuthor:!!C,lineHeight:C?void 0:"21px",marginBottom:C?void 0:"4px",shouldShowFirstNameOnly:!0,taggedUsers:eF,tags:tl,text:eO}),tR,ti&&(0,_.jsx)(l.xu,{marginBottom:2,marginTop:2,children:(0,_.jsx)(l.iP,{onTap:()=>void(!eP&&!y.translatedText&&e5(y.id),eP||ts.current!==to.SHOW_TRANSLATION?eP&&ts.current===to.SHOW_ORIGINAL&&e$({event_type:10418,view_type:3,view_parameter:ex,component:"pin"===el?13696:13697}):e$({event_type:10417,view_type:3,view_parameter:ex,component:"pin"===el?13696:13697}),eS(!eP)),children:(0,_.jsx)(l.xe,{color:"subtle",size:"300",weight:"bold",children:ts.current})})})]})}),x===eC&&(0,_.jsx)(l.xu,{alignSelf:"center",color:"primary",height:8,minWidth:8,rounding:"pill"})]}),ez&&(0,_.jsx)(l.xu,{marginBottom:C?3:1.5,marginTop:C?4:-.5,children:(0,_.jsx)(l.xe,{size:"100",children:(0,w.nk)(eV.bt("Highlighted by @{{ closeupAttributionUsername }}", "Highlighted by @{{ closeupAttributionUsername }}", "comment.highlighted.label", undefined, true),{closeupAttributionUsername:p})})}),e1&&(0,_.jsx)(l.xu,{alignItems:"center",display:"flex",height:C?25:"100%",justifyContent:"between",position:"relative",children:(0,_.jsxs)(l.kC,{alignItems:"center",gap:{row:C?5:4,column:0},children:[!P&&C&&(0,_.jsx)(l.xu,{"data-test-id":"comments-time-passed",children:(0,_.jsx)(l.xe,{color:"subtle",size:"200",children:tn(eK,!0)})}),!P&&(0,_.jsx)(l.xu,{"data-test-id":"comment-reply-button-container",children:(0,_.jsx)(l.iP,{onTap:()=>{O&&O(y,et,el)},children:(0,_.jsx)(l.xe,{color:C?"subtle":"default",size:C?"200":"100",weight:"bold",children:eV.bt("Reply", "Reply", "comment.button.reply", undefined, true)})})}),!P&&(0,_.jsx)(A,{commentId:eC,dismissReactionList:()=>{ed(void 0)},helpfulCount:eT,isDesktop:C,isLovedByMe:eR,isMarkedHelpfulByMe:eZ,isReactionListOpen:ey===eC,isTry:tt,lovedCount:eM,onReactionCountHover:()=>{ed(eC),e$({event_type:9906,component:"pin"===el?13696:13697,view_type:3,view_parameter:ex})},onToggleHelpful:e=>()=>{eZ!==e&&eu(eC,!e,tt)()},onToggleLove:e=>()=>{eR!==e&&eg(eC,!e,tt)()}}),!("id"in eU&&eU.id===eb&&e3)&&(C?(0,_.jsx)(l.xu,{ref:eX,"data-test-id":"comment-more-options",children:(0,_.jsx)(l.hU,{accessibilityControls:ta,accessibilityExpanded:tc,accessibilityHaspopup:!0,accessibilityLabel:eV.bt("More", "More", "comment.button.more", undefined, true),icon:"ellipsis",iconColor:"subtle",onClick:tA,size:"xs"})}):(0,_.jsx)(l.xu,{"data-test-id":"comment-more-options",children:(0,_.jsx)(l.iP,{accessibilityControls:ta,accessibilityExpanded:tc,accessibilityHaspopup:!0,onTap:tA,children:(0,_.jsx)(l.JO,{accessibilityLabel:eV.bt("More", "More", "comment.button.more", undefined, true),color:eY?"light":"dark",icon:"ellipsis",size:12})})}))]})})]})]}),C&&(0,_.jsxs)(a.Fragment,{children:[tu&&!(L||v)&&(0,_.jsx)(l.xu,{marginTop:3,children:(0,_.jsx)(E.Z,{clientTrackingParams:eW,commentWarningModalState:tC,dismissCommentWarningModal:tD,initialTags:y.tags,initialText:"aggregatedcomment"===y.type?y.text:y.details,isEditing:!0,objectType:q.o.aggregatedComment,onAddItem:tS,onCancelItem:tw(!1),postedPhoto:eN,showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ex})}),er===eC&&(0,_.jsx)(l.xu,{marginStart:12*!tT,marginTop:3,children:(0,_.jsx)(E.Z,{commentWarningModalState:tC,dismissCommentWarningModal:tD,initialTags:tT?[{offset:0,object_id:ef,length:tj.length,tag_type:1}]:[],initialText:tT?`${tj} `:"",isReplying:!0,objectType:q.o.aggregatedComment,onAddItem:tP,onCancelItem:()=>{O&&O()},showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ex})})]}),(ew>0||t_)&&(0,_.jsx)(l.xu,{marginStart:C?12:10,marginTop:C?4:3,children:(0,_.jsx)(K,{aggregatedPinDataId:g,closeupAttributionId:h,closeupAttributionUsername:p,featuredCommentId:x,inCommentsImprovedDropdownExp:v,inCommentsPopover:L,isDesktop:C,isLoading:t_,isORBACProfileManager:ep,isReadOnly:P,isVideo:S,openOverflowMenu:z,parentId:eC,parentType:y.type,pinId:eo,pinnerId:e_,reactionListCommentId:ey,replyingToCommentId:er,showReactionListForComment:ed,storyPinDataId:es,toggleEditComposer:em,toggleHelpful:eu,toggleLike:eg,toggleReplyComposer:O,viewParameter:ex})}),C&&e1&&(0,_.jsx)(ei,{aggregatedPinDataId:g,anchor:eX.current,closeupAttributionId:h,comment:y,dismiss:e=>{tm(!1),e||(eG(!1),e$({component:14349,event_type:10128}))},id:ta,inCommentsPopover:!!L,isOpen:tc,isReply:tT,onEdit:tw(!0),onShowBlockUserModal:tE(!0),parentId:et,pinId:eo}),tv&&(0,_.jsx)(T.Z,{children:(0,_.jsx)(c.N,{children:(0,_.jsx)(ea,{aggregatedPinDataId:g,didItDataId:eC,onClose:e=>()=>{tb(!e)},pinId:eo??"",username:eL,users:[y.user]})})}),tk&&(0,_.jsx)(T.Z,{children:(0,_.jsx)(en,{firstName:ev??"",onBlockUser:()=>{eQ((0,ee.Ge)({id:ef,orbacSubjectId:e9,blockSource:"comment",blockContext:eC,logContextEvent:e$})),e4(ef),e7(ef),e$({event_type:101,component:13712,element:87,view_type:220,aux_data:{creator_id:eU.isAuth?eU.id:null}}),e$({component:14349,event_type:9407}),tL(!1),eD(),eG(!1)},onClearModal:tE(!1)})}),!!eH&&tx&&(0,_.jsx)(D.Z,{onDismiss:()=>tz(tx),photo:eH})]})}var eo=n(79271),es=n(40763);function er(e){let t,n;(0,a.useEffect)(()=>{(0,i.Z)("CommentThread","/app/packages/comment/CommentThread.tsx")},[]);let{aggregatedPinDataId:o,comments:s,commentsDisabled:r,commentsScrollContainerRef:d,featuredCommentId:c,gapSize:m=6,id:g,inCommentsImprovedDropdownExp:h,inCommentsPopover:p,isDesktop:y,isLoading:x=!1,isReadOnly:f,openOverflowMenu:v,toggleReplyComposer:b,parentId:k,parentType:L,replyingToCommentId:C,showingCloseupCommentModule:w,toggleEditComposer:T,toggleHelpful:P,toggleLike:S,userAvatarSize:A,isORBACProfileManager:E,isVideo:D,storyPinDataId:z,pinId:M,closeupAttributionId:R,closeupAttributionUsername:Z,pinnerId:F,showReactionListForComment:O,reactionListCommentId:K,viewParameter:H}=e,N=(0,I.Z)(),{closeupWithinMasonryEnabled:V}=(0,j.x4)(),U=(0,es.Z)({skipExpActivation:!0}),B=!!w&&!1;return(p?t="12px":V&&(t="8px"),n=z?"story":D?"video":"pin",r)?(0,_.jsx)(l.xu,{alignSelf:"center","data-test-id":"comments-disabled-label",marginTop:V?2:void 0,width:"100%",children:(0,_.jsx)(l.xe,{align:y?"start":"center",color:"subtle",children:N.bt("Comments are turned off for this Pin", "Comments are turned off for this Pin", "commentThread.disabledState.message", undefined, true)})}):0!==s.length||"pin"!==L||x||y?s.length>0?(0,_.jsxs)(l.xu,{ref:d,dangerouslySetInlineStyle:{__style:{gap:`${4*m}px 0`,overscrollBehavior:p?"none":"auto",scrollbarGutter:V?"stable":void 0,paddingTop:t,overflowX:U?"scroll":void 0}},"data-test-id":"aggregated-comment-list",direction:"column",display:"flex",id:g,maxHeight:V&&!p?722:"100%",overflow:V?"auto":void 0,width:"100%",children:[s.map((e,t)=>(0,_.jsx)(eo.Fw,{componentType:"pin"===L?13696:13697,impressionAuxFields:{commentId:e.id,pinId:M,pinOwnerUserId:R,pinType:n,parentId:k,parentType:L,commentType:"aggregatedComment"},impressionType:"Comment",loggingId:e.id,slotIndex:t,viewType:y?3:98,children:({impressionTrackerRef:n})=>{let i=t===s.length-1;return(0,_.jsx)(l.xu,{ref:n,"aria-label":N.bt("Comment thread", "Comment thread", "commentThread.ariaLabel", undefined, true),dangerouslySetInlineStyle:{__style:{paddingBottom:p&&i?"24px":"0px"}},"data-test-id":"commentThread-comment",role:"group",tabIndex:0,children:(0,_.jsx)(el,{aggregatedPinDataId:o,closeupAttributionId:R,closeupAttributionUsername:Z,comment:e,featuredCommentId:c,inCommentsImprovedDropdownExp:h,inCommentsPopover:p,isDesktop:y,isORBACProfileManager:E,isReadOnly:f,isVideo:D,openOverflowMenu:v,parentId:k,parentType:L,pinId:M,pinnerId:F,reactionListCommentId:K,replyingToCommentId:C,showReactionListForComment:O,showTopCommentHeading:B&&0===t,storyPinDataId:z,toggleEditComposer:T,toggleHelpful:P,toggleLike:S,toggleReplyComposer:b,userAvatarSize:A,viewParameter:H})})}},e.id)),x&&(0,_.jsx)(l.xH,{accessibilityLabel:N.bt("Comments loading", "Comments loading", " - ", undefined, true),show:x})]}):(0,_.jsx)(l.xu,{alignSelf:"center",width:"100%",children:(0,_.jsx)(l.xH,{accessibilityLabel:N.bt("Comments loading", "Comments loading", " - ", undefined, true),show:x})}):(0,_.jsx)(l.xu,{alignSelf:"center","data-test-id":"no-comments-label",width:"100%",children:(0,_.jsx)(l.xe,{align:"center",color:"subtle",children:(0,u.OW)(N)})})}},812928:function(e,t,n){n.d(t,{Z:()=>r});var i=n(686659),a=n(667294),l=n(317109),o=n(785893);let s=(0,a.lazy)(()=>Promise.all([n.e("58588"),n.e("45474")]).then(n.bind(n,269936)));function r(e){return(0,a.useEffect)(()=>{(0,i.Z)("InlineCommentComposer","/app/packages/comment/InlineCommentComposer.tsx")},[]),(0,o.jsx)(l.Z,{fallback:null,children:(0,o.jsx)(s,{...e})})}},634395:function(e,t,n){n.d(t,{Z:()=>c});var i=n(686659),a=n(667294),l=n(399353),o=n(300704),s=n(289935),r=n(24246),d=n(785893);function c({onDismiss:e,photo:t}){(0,a.useEffect)(()=>{(0,i.Z)("MediaViewer","/app/packages/comment/MediaViewer.tsx")},[]);let n=(0,r.Z)(),{height:c,url:m,width:u}=t,g=Math.min(c??936,936),h="100vh",p=n.bt("Close media viewer", "Close media viewer", "comments.photo.mediaViewer.close", undefined, true);return(0,d.jsxs)(l.mh,{zIndex:s.b7,children:[(0,d.jsx)(l.iP,{mouseCursor:"zoomOut",onTap:e,children:(0,d.jsxs)(l.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},"data-test-id":"comment-media-viewer",display:"flex",height:h,justifyContent:"center",left:!0,position:"fixed",right:!0,top:!0,width:"100%",children:[(0,d.jsx)(l.xu,{left:!0,padding:5,position:"absolute",top:!0,children:(0,d.jsx)(l.hU,{accessibilityLabel:p,icon:"close",iconColor:"inverse",onClick:e,padding:3,size:"lg"})}),(0,d.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{margin:"0 84px"}},height:h,maxHeight:g,width:u,children:m&&(0,d.jsx)(l.Ee,{alt:m??"",fit:"contain",naturalHeight:c??1,naturalWidth:u??1,src:m},m)})]})}),(0,d.jsx)(o.Z,{onClose:e})]})}},351979:function(e,t,n){n.d(t,{Vb:()=>p,ZP:()=>y,mu:()=>_});var i=n(686659),a=n(667294),l=n(399353),o=n(219077),s=n(458465),r=n(55806),d=n(634395),c=n(24246),m=n(774838),u=n(739405),g=n(113759),h=n(785893);let p=150,_=346;function y({canEnlargePhoto:e,containerWidth:t,isSelectedPhoto:n,previewPhoto:y,removeSelectedPhoto:x}){(0,a.useEffect)(()=>{(0,i.Z)("PhotoCommentPreview","/app/packages/comment/PhotoCommentPreview.tsx")},[]);let f=(0,c.Z)(),v=(0,u.HG)(),{isRTL:b}=(0,m.B)(),{setIsMediaViewerOpen:k}=(0,g.x4)(),[L,C]=(0,o.Z)(),[I,w]=(0,a.useState)(!1),[T,j]=(0,a.useState)(!1),[P,S]=(0,a.useState)(null),[A,E]=(0,a.useState)(s.WU),D=(0,r.Z)(y)?y?.url:y?.image_url;(0,a.useEffect)(()=>{(async()=>{D&&!(0,r.Z)(y)&&S(await new Promise((e,t)=>{let n=new Image;n.onload=()=>{e({width:n.width,height:n.height})},n.onerror=t,n.src=D}))})()},[D,y]);let z=(0,r.Z)(y)?y?.width:P?.width,M=(0,r.Z)(y)?y?.height:P?.height,R=z??0,Z=M??0,F=D??"",O=Math.min((t||(v?_:312))/R,(v?p:110)/Z,1),K=f.bt("Remove photo", "Remove photo", "photoCommentPreview.removePhoto", undefined, true),H=f.bt("Photo", "Photo", "photoCommentPreview.previewPhoto", undefined, true),N=e=>{e?C():L(),k(!e),w(!e)};return(0,h.jsxs)(l.xu,{height:O*Z,marginTop:3*!!n,position:"relative",width:O*R,children:[(0,h.jsx)(l.iP,{disabled:!e,onMouseEnter:()=>j(!0),onMouseLeave:()=>j(!1),onTap:()=>N(I),children:(0,h.jsx)(l.zd,{rounding:2,children:F&&(0,h.jsx)(l.Ee,{alt:H,color:A,naturalHeight:Z,naturalWidth:R,onLoad:()=>{E(s.o),n&&URL.revokeObjectURL(F)},src:F,children:e&&(0,h.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{cursor:"zoom-in",backgroundColor:`rgba(17, 17, 17, ${.4*!!T})`}},height:"100%",width:"100%"})},H)})}),n&&(0,h.jsx)(l.xu,{alignItems:"center",display:"flex",height:24,justifyContent:"center",left:b,marginEnd:-3,marginTop:-3,position:"absolute",right:!b,top:!0,width:24,children:(0,h.jsx)(l.hU,{accessibilityLabel:K,bgColor:"secondary",icon:"close",onClick:x,size:"xs"})}),I&&(0,h.jsx)(d.Z,{onDismiss:()=>N(I),photo:y})]})}},299136:function(e,t,n){n.d(t,{Z:()=>s});var i=n(686659),a=n(667294),l=n(399353),o=n(785893);let s=({inCommentFeedPreview:e,isFirstTaggedUserAuthor:t,lineHeight:n,marginBottom:s,marginEnd:r,shouldShowFirstNameOnly:d,size:c,tags:m,taggedUsers:u,text:g})=>{(0,a.useEffect)(()=>{(0,i.Z)("TaggedText","/app/packages/comment/TaggedText.tsx")},[]);let h=(0,a.useRef)(null),p=(e,t)=>(0,o.jsx)(l.xe,{inline:!0,overflow:"normal",size:c,children:(0,o.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:n,overflowWrap:"anywhere",display:"inline"}},"data-test-id":"text-container",children:e})},t);return(0,o.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap",wordWrap:"break-word",marginBottom:s}},children:(()=>{if(!m.length||!u||m.length!==u.length)return p(g,"1");let i=0,a=[];return m.forEach((n,s)=>{let r=g.substring(i,n.offset);i=n.offset+n.length;let m=g.substring(n.offset,i);a=a.concat(p(r,`${s}a`)).concat(((n,i,a,s)=>{let r=d||0===a&&t?u[a].first_name||u[a].username[0]:i;return(0,o.jsx)(l.xe,{color:n,inline:!0,overflow:"normal",size:c,weight:"bold",children:e?r:(0,o.jsx)(l.rU,{display:"inlineBlock",href:`/${u[a].username}`,underline:"hover",children:r})},s)})(n.color,m,s,`${s}b`))}),a=a.concat(p(g.substring(i),"2")),(0,o.jsx)(l.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:n}},display:d?"flex":void 0,marginEnd:r??3,position:"relative",children:(0,o.jsx)(l.xe,{ref:h,inline:!0,lineClamp:e?1:void 0,size:c,children:a})})})()})}},458465:function(e,t,n){n.d(t,{A9:()=>p,F1:()=>I,Ff:()=>C,G5:()=>w,G_:()=>L,Gu:()=>k,LH:()=>s,OW:()=>f,Rv:()=>m,TJ:()=>g,Ty:()=>l,WU:()=>y,XU:()=>c,_q:()=>S,i$:()=>x,iB:()=>o,je:()=>r,mi:()=>T,o:()=>_,pW:()=>h,qJ:()=>A,sp:()=>j,uC:()=>d,xA:()=>u,yQ:()=>P,yW:()=>b,zs:()=>v});var i=n(399353),a=n(696749);let l=new i.Ry(3),o=48,s=56,r="sm",d=500,c=1,m=Object.freeze({TOP:0,REPLY_TO_TRIED:1,REPLY_TO_AGGREGATED:2}),u=Object.freeze({PHOTO:0,STICKER:1,PIN:2}),g="comment_featured_ids",h="did_it_featured_ids",p={NONE:"none",WARNING:"warning",BLOCK:"block"},_="transparent",y="#efefef",x=(e,t)=>e?(0,a.Z)(t.nbt(["{{ count }} comment", "{{ count }} comments"], e, "closeup.commentThread.heading.commentCount", true),{count:e.toString()}):t.bt("No comments yet", "No comments yet", "closeup.commentThread.heading.noComments", undefined, true),f=e=>e.bt("Write a comment, share feedback or give a high-five to get the conversation going", "Write a comment, share feedback, or give a high-five to get the conversation going", "emptyCommentThread.noComments.text", undefined, true),v=(e,t,n,i)=>{let a=t.map(t=>({...t,offset:(t.offset||0)+(i?0:e.length+1),color:"default"}));return i?a:[{offset:0,length:e.length,color:n?"light":"dark"},...a]},b=e=>e.bt("Insight heading icon", "Insight heading icon", "closeupCommentModuleHeading.icon", undefined, true),k=e=>e.bt("No comments yet", "No comments yet", "emptyCommentThread.noComments.heading", undefined, true),L=e=>e.bt("Post", "Post", "commentComposer.button.post", undefined, true),C=e=>e.bt("posted a photo", "posted a photo", "comment.preview.text.photo", undefined, true),I=e=>e.bt("posted a sticker", "posted a sticker", "comment.preview.text.sticker", undefined, true),w=e=>e.bt("Select an emoji", "Select an emoji", "emojitray.button.accessibilityLabel", undefined, true),T=e=>e.bt("Select a photo", "Select a photo", "photoModal.button.accessibilityLabel", undefined, true),j=e=>e.bt("Select a sticker", "Select a sticker", "stickerTray.button.accessibilityLabel", undefined, true),P=e=>e.bt("Text editor", "Text editor", "EditorWithMentions.container", undefined, true),S=e=>e.bt("Top comment", "Top Comment", "closeupCommentModuleHeading.heading.topComment", undefined, true),A=e=>[w(e),T(e),L(e),j(e),P(e)]},55806:function(e,t,n){n.d(t,{Z:()=>i});let i=e=>e?.url!==void 0},296339:function(e,t,n){n.d(t,{Z:()=>d});var i,a=n(667294);n(167912);var l=n(183e3),o=n(173922);let s=(void 0!==i||(i=n(562802)).hash&&"bd2991a5190c2f6977d6f49024eb3318"!==i.hash&&console.error("The definition of 'useGetMainPinImage_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i);function r(e,t){return e&&t?`${e} ${t}w`:null}function d({pinKey:e}){let t=(0,l.Z)(s,e),{anyEnabled:n,group:i}=(0,o.Z)(),d=(0,a.useMemo)(()=>t?.images_736x||t?.images_564x||t?.images_orig||t?.images_474x||t?.images_236x,[t]),c=(0,a.useMemo)(()=>{if(!t)return;let e=[r(t.images_736x?.url,t.images_736x?.width),r(t.images_1200x?.url,t.images_1200x?.width),{enabled:null,enabled_564x:r(t.images_564x?.url,t.images_564x?.width),enabled_orig:r(t.images_orig?.url,t.images_orig?.width)}[i]].filter(Boolean);return e.length>1?e.join(", "):void 0},[t,i]),m=n?"100cqw":void 0;return(0,a.useMemo)(()=>({mainPinImage:{url:d?.url||"",height:d?.height||1,width:d?.width||1},srcSet:c,srcSizes:m}),[d,c,m])}},17658:function(e,t,n){n.d(t,{Z:()=>a});var i=n(667294);function a(e,t){let n=(0,i.useRef)([]),[a,l]=(0,i.useState)(),[o,s]=(0,i.useReducer)(a??(()=>t),t),r=(0,i.useCallback)(t=>{a?s(t):(n.current.length||e().then(e=>{l(()=>e.default)}),n.current=[...n.current,t])},[e,a]);return(0,i.useEffect)(()=>{a&&(n.current.forEach(s),n.current=[])},[a]),[o,r]}},872003:function(e,t,n){n.d(t,{G:()=>u,Kl:()=>g,vo:()=>m});var i=n(667294),a=n(213491),l=n(57887),o=n(17658),s=n(785893);let r=()=>n.e("65333").then(n.bind(n,557189)),{Provider:d,get:c}=(0,a.Z)("NativeEngagements");function m({children:e}){let[t,n]=(0,o.Z)(r,[]);(0,l.Z8)("NativeInteractionsResource",e=>{n({type:"FETCH_COMPLETE",payload:e})}),(0,l.my)("NativeInteractionsResource",e=>{n({type:"FETCH_MORE_COMPLETE",payload:e})});let a=(0,i.useMemo)(()=>({dispatch:n,nativeEngagements:t}),[n,t]);return(0,s.jsx)(d,{value:a,children:e})}function u(){let{dispatch:e}=c();return(0,i.useMemo)(()=>({nativeEngagementsHiddenForUser:t=>{e({type:"NATIVE_ENGAGEMENT_HIDDEN_FOR_USER",payload:{userId:t}})}}),[e])}function g(){let{nativeEngagements:e}=c();return e}},373779:function(e,t,n){n.d(t,{B:()=>D,Z:()=>M});var i,a,l,o=n(686659),s=n(667294),r=n(581722);n(167912);var d=n(399353),c=n(671862),m=n(935059),u=n(183e3),g=n(422578),h=n(244311),p=n(790985),_=n(707855),y=n(785575);let x=function({graphQLMutation:e,legacyOperation:t,dataKeyOrStrategy:n}){let i="Strategy"===n.kind?n.strategy:"GraphQL"===(0,_.g)(n.fragmentRef).kind?"GraphQL":"Legacy",[a,l]=(0,s.useState)(!1);switch((0,y.Z)(i,()=>(0,h.getFragment)(e).name),i){case"GraphQL":{let[t,n]=(0,g.useMutation)(e);return[(0,s.useCallback)(({variables:e,onCompleted:n,onError:i,updater:a,uploadables:l,optimisticUpdater:o,optimisticResponse:s,configs:r,onUnsubscribe:d})=>{t({variables:e,onCompleted:(e,t)=>{n&&n({kind:"GraphQL",data:e},t)},onError:i,updater:a,uploadables:l,optimisticUpdater:o,optimisticResponse:s,configs:r,onUnsubscribe:d})},[t]),n]}case"Legacy":return[(0,s.useCallback)(e=>{l(!0),t(e.variables).then(t=>{e.onCompleted&&e.onCompleted({kind:"Legacy",data:t},null)}).catch(t=>{e.onError&&e.onError(t)}).finally(()=>{l(!1)})},[t]),a];default:return(0,p.Z)(i,"Unknown mode")}};var f=n(501010),v=n(661376),b=n(739405),k=n(893957),L=n(200619),C=n(601871),I=n(264267),w=n(107889),T=n(301527),j=n(426130),P=n(646239),S=n(157498),A=n(305375),E=n(785893);let D=({aggregatedPinDataId:e,featuredCommentIds:t,featuredDidItIds:n,isDesktop:i,isReversed:a=!1,noCache:l=!1,orbacSubjectId:o=""})=>({name:"UnifiedCommentsResource",options:{aggregated_pin_id:e,comment_featured_ids:t,did_it_featured_ids:n,page_size:i?10:25,redux_normalize_feed:!0,is_reversed:a,...o?{orbac_subject_id:o}:{}},noCache:l}),z=(void 0!==i||(i=n(966597)).hash&&"38e173ab2c3107ebc5b3da9f216fac98"!==i.hash&&console.error("The definition of 'CommentThreadContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),M=({isReadOnly:e,pinKey:t,scrollContainer:i,showingCloseupCommentModule:g,viewParameter:h,toggleComposerForReply:p,openMwebOverflowMenu:_})=>{(0,s.useEffect)(()=>{(0,o.Z)("CommentThreadContainer","/app/www/comments/CommentThreadContainer.tsx")},[]);let{comment_id:y}=(0,A.Z)(),M=(0,r.I0)(),R=(0,b.HG)(),Z=(0,m.Z)(),F=(0,f.Z)().checkExperiment("web_use_mutation_or_legacy_experiment").anyEnabled,O=(0,u.Z)(z,t),K=(O?.aggregatedPinData?.commentCount||0)+(O?.aggregatedPinData?.didItData?.imagesCount||0),H=O?.aggregatedPinData?.entityId,N=O?.closeupAttribution?.entityId,V=O?.closeupAttribution?.username,U=O?.commentsDisabled,B=K>0&&!O?.commentsDisabled,W=!!O?.videos?.videoList,G=O?.entityId,$=O?.pinner?.entityId,q=O?.storyPinData?.entityId,J=(0,s.useRef)(B),Q=(0,L.Z)(),Y=(0,C.lJ)(Z,Q),X=F?"GraphQL":"Legacy",[ee]=x({dataKeyOrStrategy:{kind:"Strategy",strategy:X},graphQLMutation:(void 0!==a||(a=n(177303)).hash&&"6abad0b1546231dd9301ca5510fb88f5"!==a.hash&&console.error("The definition of 'CommentThreadContainerLikeMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a),legacyOperation:({userDidItData:e})=>(0,j.aX)({didItDataId:e,orbacSubjectId:Y})}),[et]=x({dataKeyOrStrategy:{kind:"Strategy",strategy:X},graphQLMutation:(void 0!==l||(l=n(483416)).hash&&"e8e5a11ac4f4d2e8c4a2ed9c7ee3c073"!==l.hash&&console.error("The definition of 'CommentThreadContainerUnLikeMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l),legacyOperation:({userDidItData:e})=>(0,j.Wx)({didItDataId:e,orbacSubjectId:Y})}),en=(0,v.Z)(J.current&&H?D({aggregatedPinDataId:H,featuredCommentIds:y?[y]:[],isDesktop:R}):null),{removeUnauthCommentPinId:ei,unauthCommentPinId:ea}=(0,T.o)(),el=(0,I.lV)(),{toggleAggregatedCommentHelpful:eo,toggleAggregatedCommentLike:es}=(0,I.nf)(),er=(0,S.dM)(),ed=(0,r.v9)(e=>(0,P.Z)(e,{aggregatedPinDataId:H,aggregatedComments:el,users:er})),[ec,em]=(0,s.useState)(void 0);(0,k.Z)(()=>{!R&&Z.isAuth&&ea&&G&&ea===G&&ei()}),(0,s.useEffect)(()=>{let e=()=>{let t=!!i&&i.scrollTop+i.clientHeight+10>=i.scrollHeight;en&&!en.isFetching&&(en.isAtEnd?i?.removeEventListener("scroll",e):t&&en.fetchMore())};return i?.addEventListener("scroll",e),()=>{i?.removeEventListener("scroll",e)}},[en,i]);let eu=2*(!R&&!U);return(0,E.jsx)(s.Fragment,{children:(0,E.jsx)(d.xu,{display:"flex",height:R||U||0!==ed.length?void 0:"100%",marginTop:R?6:eu,width:"100%",children:(0,E.jsx)(c.Z,{aggregatedPinDataId:H,closeupAttributionId:N,closeupAttributionUsername:V,comments:ed,commentsDisabled:U,isDesktop:R,isReadOnly:e,isVideo:W,openOverflowMenu:_,parentId:H??"",parentType:w.o.pin,pinId:G,pinnerId:$,reactionListCommentId:ec,showingCloseupCommentModule:g,showReactionListForComment:em,storyPinDataId:q,toggleHelpful:(e,t,n)=>()=>{n?M((0,j.YH)({didItDataId:e,isMarkedHelpfulByMe:t,orbacSubjectId:Y})):eo({aggregatedCommentId:e,isMarkedHelpfulByMe:t,orbacSubjectId:Y})},toggleLike:(e,t,n)=>()=>{n?t?et({variables:{userDidItData:e},onCompleted:(n,i)=>{n&&!i&&M((0,j.uL)(e,!t))}}):ee({variables:{userDidItData:e},onCompleted:(n,i)=>{n&&!i&&M((0,j.uL)(e,!t))}}):es({aggregatedCommentId:e,isLikedByMe:t,orbacSubjectId:Y})},toggleReplyComposer:p,userAvatarSize:"sm",viewParameter:h})})})}},301527:function(e,t,n){n.d(t,{o:()=>s,p:()=>r});var i=n(667294),a=n(213491),l=n(785893);let{Provider:o,get:s}=(0,a.Z)("Session");function r({children:e}){let[t,n]=(0,i.useState)(void 0),a=(0,i.useCallback)(()=>n(void 0),[]),s=(0,i.useMemo)(()=>({unauthCommentPinId:t,setUnauthCommentPinId:n,removeUnauthCommentPinId:a}),[t,a]);return(0,l.jsx)(o,{value:s,children:e})}},646239:function(e,t,n){n.d(t,{Z:()=>o});var i=n(442279),a=n(438274);let l={},o=(0,i.createSelector)((e,{aggregatedComments:t})=>t,({feeds:e},{aggregatedPinDataId:t})=>e[`${a.Z.UNIFIED_COMMENTS}:${t||""}`],({didItData:e})=>e,(e,{users:t})=>t??l,(e,t,n,i)=>{let a=new Set;return t?.map(({id:t,type:o})=>{if(a.has(t))return;a.add(t);let s="aggregatedcomment"===o.toLowerCase()?e[t]:n[t];if(!s)return;let r="user"in s&&("string"==typeof s.user?i[s.user]??l:s.user??l);return{...s,user:r??l}}).filter(e=>void 0!==e)||[]})},333651:function(e){e.exports="https://s.pinimg.com/webapp/commentHelpful-88dadefe.svg"},773655:function(e){e.exports="https://s.pinimg.com/webapp/commentLoved-04ae890e.svg"}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/10123.en_GB-1202aedcf3de047e.mjs.map